<div class="row">
    <ng-container *ngIf="readyForUI$ | async">
        <div class="col-lg-12" [formGroup]="testStartPageForm">
            <div class="card">
                <h5 class="card-header border-bottom-0 text-uppercase" translate>pages.testStartPage.instruction</h5>
                <div class="card-body">
                    <label translate>pages.testStartPage.instructionHint</label>
                    <editor vietGeeksEditorLoadingIndicator class="simple-editor" formControlName="instruction" [apiKey]="textEditorConfigs.apiKey"
                        (onInit)="textEditorConfigs.handleEditorInit('testEndConfig.message', $event)"
                        (onFocusOut)="gdprErrorTailor.showError()" [init]="textEditorConfigs.simpleEditorConfig"
                        #gdprErrorTailor="errorTailor" [controlErrorAnchor]="messageAnchor"></editor>
                    <ng-template controlErrorAnchor #messageAnchor="controlErrorAnchor"></ng-template>
                </div>
            </div>
            <div class="card">
                <h5 class="card-header border-bottom-0" translate>pages.testStartPage.respondentForm</h5>
                <div class="card-body">
                    <label translate>pages.testStartPage.respondentFormHint</label>
                    <table class="table caption-top table-nowrap" formArrayName="respondentIdentifyConfig" aria-describedby="">
                        <thead class="table-light">
                            <tr class="text-center">
                                <th scope="col" translate>pages.testStartPage.field</th>
                                <th scope="col" translate>pages.testStartPage.fieldMandatory</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let control of respondentIdentifyConfig.controls; let i = index">
                                <tr [formGroup]="control">
                                    <td>
                                        <select data-choices formControlName="fieldId" class="form-select" readonly>
                                            <option [ngValue]="field.value" *ngFor="let field of fieldConfigs">
                                                {{'pages.testStartPage.respondentFormFields.' + field.key | translate}}</option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" role="switch" formControlName="isRequired"
                                            class="form-check-input">
                                    </td>
                                    <td>
                                        <div class="hstack gap-2">
                                            <button type="button" class="btn btn-outline-secondary"><i
                                                    class="ri-arrow-up-s-line"></i></button>
                                            <button type="button" class="btn btn-outline-secondary"><i
                                                    class="ri-arrow-down-s-line"></i></button>
                                            <button type="button" class="btn btn-outline-secondary"
                                                (click)="respondentIdentifyConfig.removeAt(i)"><i
                                                    class="ri-delete-bin-5-line"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                    <div class="hstack gap-3">
                        <button type="button" class="btn btn-outline-secondary btn-label" (click)="addNewField()">
                            <i class="ri-add-line label-icon align-middle fs-24 me-2"></i>{{ 'pages.testStartPage.addField' | translate }}</button>
                        <button type="button" class="btn btn-outline-secondary btn-label" disabled>
                            <i class="ri-pencil-line label-icon align-middle fs-24 me-2"></i>{{ 'pages.testStartPage.manageCustomFields' | translate }}</button>
                    </div>
                </div>
            </div>
            <div class="card">
                <h5 class="card-header border-bottom-0 text-uppercase" translate>pages.testStartPage.consent</h5>
                <div class="card-body">
                    <label translate>pages.testStartPage.consentHint</label>
                    <editor vietGeeksEditorLoadingIndicator class="simple-editor" formControlName="consent" [apiKey]="textEditorConfigs.apiKey"
                        (onInit)="textEditorConfigs.handleEditorInit('testEndConfig.message', $event)"
                        (onFocusOut)="gdprErrorTailor.showError()" [init]="textEditorConfigs.simpleEditorConfig"
                        #gdprErrorTailor="errorTailor" [controlErrorAnchor]="messageAnchor"></editor>
                    <ng-template controlErrorAnchor #messageAnchor="controlErrorAnchor"></ng-template>
                </div>
            </div>
            <div class="text-end mb-4">
                <div class="d-flex gap-1 justify-content-end">
                    <viet-geeks-submit-button [class]="'btn btn-primary w-sm'" [submitFunc]="submitFunc"
                        [canSubmit]="canSubmit"></viet-geeks-submit-button>
                </div>
            </div>
        </div>
    </ng-container>
</div>
